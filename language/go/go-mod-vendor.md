# go mod vendor

## go mod vendorとは？

`go mod vendor`とは、Goのモジュールシステムにおけるコマンドの1つである。 　

`go mod vendor`を実行すると、ビルドとテストに必要な全ての依存パッケージのコピーをvendorディレクトリに格納する。

vendoringが有効な場合、goコマンド(ex:go buildやgo test等)はソースからモジュールキャッシュをダウンロードする代わりに、
vendorディレクトリからパッケージをロードしてビルドやテストを実行してくれる。

Go1.14以上の場合は、ルートディレクトリにvendorディレクトリがあれば自動的にvendorディレクトリが使用される
(現行バージョンだとvendoringはデフォルトでONになっているという認識で良さそう)

明示的に無効にしたい場合は、goコマンドに`-mod=readonly`または`-mod=mod`のオプションを使用する。

## メリット

- ネットワーク不要でビルド可能になる
- 依存パッケージのバージョンを固定できる(ビルドの安定度向上等)

## デメリット

- リポジトリサイズの肥大化
- 依存パッケージが更新された場合は再度コマンド実行が必要

## 実際のユースケースを考えてみる

現在自分が担当しているGoを使用したプロジェクトではdockerコンテナ上で開発をしており、
コンテナを破棄してイメージの再ビルド(docker compose down && up)を行う度にモジュールダウンロードが発生するため、
ローカルでの開発での速度向上には良いのかもしれない(と教えてもらった)

ただ注意点としては、複数人で開発を行うときはgit管理対象外にするのは必須なのと、<br>
依存パッケージの更新時は、go mod vendorを再実行することを忘れずないようにする。

## 参考

[go mod vendor](https://go.dev/ref/mod#go-mod-vendor)

[Vendoring](https://go.dev/ref/mod#vendoring)
