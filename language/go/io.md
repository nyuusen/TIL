# I/O

## io vs bufio

- bufio(Buffered I/O)の方が高速
  - 書き込みの際、メモリ上のバッファにためて、バッファがいっぱいになるor明示的に指示された時に溜まったデータをまとめて書き込むため
- ただし以下の例外あり
  - 既にデータが大きい場合：一度に大きな塊を書き込むなら、メモリ間のコピーが無駄なステップを増やすだけ
  - リアルタイム性が必要な場合：バッファが溜まっている間にプログラムがクラッシュするとまだ書き出されていないデータが消える
  - OSが既にバッファリングしている場合：現代のOS

## File構造体

- File構造体は以下のようになっている
  ```
    type File struct {
  	  *file // os specific
    }
  ```
- これはGoでよくみられる埋め込み（Embedding）というテクニックで継承に近い
- 利用者側からは抽象化されたメソッド（例：Write）で呼び出すことができ、その内部の処理は非公開型に隠蔽されている
  - 例えばファイル書き込み処理をしたい場合、ファイル構造体を作った後にWriteメソッドを呼ぶだけで、OSの違い（LinuxとWindowsなど）を意識する必要がなくて済む