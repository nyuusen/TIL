# Base64

[JPG画像をBase64で送るとサイズが33%増えるが、Gzip圧縮すれば「ほぼ元通り」になるという話 #コンピューターサイエンス - Qiita](https://qiita.com/shiozaki/items/9d7aeac0dd6733a6e2fb)

という面白い記事を見たのでちょっと深掘り。

## そもそもBase64って？

- 64進数(Base)
- `A-Z, a-z, 0-9, +, /`の64個の記号を使用する
- 64進数というのは2の6乗で、1文字（1バイト）あたり6ビット使用する
  - つまり元々の1文字あたり8ビットと比較すると4/3倍≒約33.3%データ量が増えることになる
- 生のバイナリを構成する0〜255の中にはNULLや改行などの制御文字が含まれており、これらをそのまま送信すると、ルーターやメールサーバーなどのネットワーク機器が「これはデータではなく通信を終了するという合図だ」などと誤解してしまったり、SMTPは7ビットのテキストデータしか通さないなどの制約があった
- これを避けるために、どんなに古い機器でも安全な64個だけでやり取りするというのがBase64誕生の背景

## multipart/form-dataではなぜ生のバイナリを流せる？

- Boundaryという境界文字(`Content-Type: multipart/form-data; boundary=----MyBoundary`を例にすると`MyBoundary`)を使って、通信路ではこの境界文字が出るまでは中身がNULLであっても改行でも、全てを無視して（制御文字として解釈させない）バイナリとしてバッファに詰めろというルールで動くため
  - 実際のBoundaryの文字列は、ブラウザがデータの中身と絶対に被らないようなランダム文字列を生成する
