# ゼロからはじめるLinuxサーバー構築・運用ガイド

## 1章 Linuxって何？

### 1. LinuxとはどのようなOSか

- Linux誕生当初はUnixが強力なOSとして存在していたが、一般の人たちが使える状況ではなかった
  - そこでUnixっぽいOSとして作られたのがLinux
  - Unixは発展の過程でいくつも枝分かれしてきており、現在Unixという1つのOSがあるわけではない
  - 現在あるものとしては、macOSやAIXなどがある
- Linuxは、上記のUnixとは異なり、ゼロから開発されたOSである
  - ただし、Unixの標準仕様であるPOSIXに準拠しているので、Unix系OSと呼ばれる
  - Linuxは、Unix系OSと多くのコマンドが共通しており、Unix向けソフトウェアの多くはLinuxでも使用できる
- Linuxというのは「カーネル」の名前
  - カーネルは、OSの中核となるプログラムであり、カーネルだけではOSとして使えない
  - 利用者とカーネルの仲介役となる「シェル」等があることで初めてOSとして利用できる
  - カーネルとこれら周辺のソフトウェアを組み合わせたものを「ディストリビューション」と呼ぶ
- ディストリビューションは、大きく分けるとRedHat系とDebian系の2つの系統がある
  - **RedHat系**
    - Fedora: 先進的。半年に1回バージョンアップがあるので長期利用には向かない。
    - RHEL: 企業向け。Fedoraの成果を取り込んで安定したソフトウェアを提供。バージョンアップ速度もゆったり。
    - CentOS Stream: 
      - 元々CentOSは、RHELからサポートを取り除いた同じバイナリ互換性を持っており、人気だった。
      - が、CentOSはサポートが停止され、RHELの開発版に近い位置付けでCentOS Streamが提供される形となっている
    - Rocky Linux: 従来のCentOSに近い。中期的なスパンで安定してアップデートされる。
  - **Debian系**
    - Debian GNU/Linux
      - フリーソフトウェアだけで作られており、長い歴史がある
      - 無償
      - サーバー・クライアントどちらでも使用可能
      - 初心者にはややハードルが高い
      - GNUとは？
        - フリーソフトウェアのみを使用し、UNIX互換のコンピュータ環境を作ることを目標としているプロジェクト
        - カーネルはGNUの製品ではないものの、ディストリビューションの多くはGNUの製品であり、GNU/Linuxと呼ぶべきという意見もある
      - Ubuntu
        - Debian GNU/Linuxから枝分かれした派生ディストリビューション
        - 初心者に配慮した使いやすさを追求
        - デスクトップ用途で人気があり、サーバー版もある
        - 半年に1度の(メジャー)バージョンアップ
        - 2年に1回LTS版が出るので、バージョンアップをなるべく避けたい場合はそちらを使うと良い

### 2. Linuxとソフトウェア

- ![image](https://www.pc-koubou.jp/magazine/wp-content/uploads/2019/03/iiyama_linux_01.png)
  - シェル:
    - カーネルとユーザーを仲介するプログラム
    - 入力を受け付けて実行したりする
  - コマンド:
    - 多くは実行形式のプログラム
    - シェルにコマンド名を入力すると対応するプログラムが実行される
  - ライブラリ:
    - プログラムの共通部品
    - プログラムが正常動作するには、そのプログラムが利用するライブラリが適切なバージョンでインストールされている必要がある
  - GUI:
    - グラフィカルなユーザーインターフェイス
    - Linuxカーネルとは別のプログラム群で作られており、サーバー版ではGUIなしの軽量なシステムとして運用できる
- カーネル
  - ![image](https://cdn-xtech.nikkei.com/atcl/nxt/column/18/02898/072200001/zu02.jpg?__scale=w:500,h:273&_sh=0f1067090c)
  - OSの中核プログラム

## 3章 基本的なコマンドを覚えよう

- Linuxで扱われるファイルを分類すると以下の4種類となる
  - 通常ファイル
  - ディレクトリ
  - リンクファイル
  - 特殊ファイル（デバイスを表すデバイスファイルなど）
- デバイスファイルはUnix系OS特有であり、**Linuxでは全てをファイルで表す**
  - コンピュータに接続されているデバイス、モニター、キーボードなどそれぞれに対応したデバイスファイルが存在する
  - 例えば、プリンターを表すデバイスファイルに文字を書き込むと、プリンタから出力されるようなイメージ
  - 全てをファイルとして抽象化することで、デバイスの扱いをシンプルにしている
- Windowsでは、.txtや.exeといった拡張子が意味を持ち、アプリケーションと関連付けられているが、Linuxではファイル名の一部にすぎない
  - なので、Windows
- 圧縮系のコマンド
  - gzip
    - 最も一般的
    - 高速軽量
    - 圧縮率はそこまで
  - bzip2
    - gzipより圧縮率高いが、遅い
  - xz
    - 圧縮率が非常に高い
    - gzipやbzip2ほど広くサポートされていない
  - zip
    - 圧縮とアーカイブを同時に行う
    - Windows環境との互換性が高い
    - 圧縮率はbzip2やxzより低い
- アーカイブのコマンド
  - tar
    - 圧縮機能はなく、複数のファイルを1つのアーカイブ(書庫)にまとめる
    - 他の圧縮ツール(gzip)等と組み合わせて使用される
      - -z(--gzip)オプションでアーカイブ＋圧縮
- 圧縮とアーカイブの違い
  - 圧縮:
    - ファイルのサイズを小さくすることを目的とする
    - ファイル内のデータをアルゴリズムを使って圧縮し、ディスク容量を節約する
    - 圧縮されたファイルは元のファイルより小さくなるが、単一のファイルとして扱われる
  - アーカイブ:
    - 複数のファイルやディレクトリを1つのファイルにまとめることを目的とする
    - ファイルをまとめて1つのアーカイブファイルにするが、サイズは変わらない
  - 圧縮とアーカイブの組み合わせ
    - これらはよく組み合わせて利用される
    - 複数ファイルをtarでアーカイブし、gzipで圧縮する
    - ディスク/通信容量を削減したい・ファイル数を減らしたいバックアップや転送時によく使用される

## 4章 ネットワーク

- IPアドレスは32ビット
  - 人間にわかりやすいよう8桁区切り10進数で表記される
- IPアドレスはネットワーク部とホスト部で構成される
  - その境界(ネットワーク部)を表すのにサブネットマスクがセットで用いられる
  - 同一ネットワークアドレス(1つのLANの中にある)機器同士は直接通信することができる
    - 逆にそうではない場合はルータを介す必要がある
- IPアドレスとクラス
  - サブネットマスクを簡潔に表現するのがCIDR表記(`192.168.0.0/255.255.255.0`と`/24`は同じ意味)
  - CIDR（Classless Inter-Domain Routing）以前のIPアドレス設計とは？
    - ネットワーク機器の性能も乏しく、アドレスの経路制御も複雑なことはできなかった
    - そこで考案されたのがIPアドレスをいくつかの「クラス」に分ける設計
    - アドレス空間の管理がシンプルとなり、ルータがアドレスのプレフィックス（最初のビット）を見て簡単に判断できるという利点があった
      - クラスA: ネットワーク部のビット数が8(ex: `10.0.0.0`)
      - クラスB: ネットワーク部のビット数が16(ex: `172.16.0.0`)
      - クラスC: ネットワーク部のビット数が24(ex: `192.168.0.0`)
- プライベートIPアドレスとグローバルIPアドレス
  - ホスト部のビットを全て0にしたアドレスを「ネットワークアドレス」
    - ネットワークそのものを表す
  - 全て1にしたアドレスを「ブロードキャストアドレス」という
    - 同じネットワークに属するすべてのホストに一斉送信する特殊なアドレス
- ホスト名とドメイン名
  - `/etc/hosts`ファイルはホスト名とIPアドレスを対応させるためのファイル
    - DNSが普及する前は、このファイルにインターネット上のホスト一覧がずらり並んでいた
    - インターネットが大きくなるにつれ、埒があかなくなり、現在のDNSによる名前解決が行われることになった
    - ただローカル環境や小規模環境では、`/etc/hosts`ファイルでの名前解決で十分なので、今でも活躍するシーンはある
      - ちなみに名前解決をしようとする際、DNSサーバーより`/etc/hosts`ファイルの方が優先される（OSにより設定ファイルがあったりするがデフォルトはそうなっているはず）

## 6章 構築

- 