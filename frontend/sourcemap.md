# SourceMap

## SourceMapとは？

- コンパイル前とコンパイル後の対応関係を示すJSON形式のファイル
- .mapというファイル
- 具体的には、元のソースコードのファイル名や行列情報が含まれている

## 必要性

- デバッグ効率を上げるため
  - 元のソースコードをコンパイルしてミニファイしてバンドルして1つのファイルの結合した後でもマップしてくれる
  - これによりDevToolsでは、読みづらいコードではなく、元のソースコードを読み取ってデバッグが可能になる

## 生成方法

以下のビルドツール等で生成可能

- TypeScriptコンパイラ
- SASSやPostCSS
- Babel: CSSとJavaScriptの両方のソースマップを生成できる
- WebpackやVite

## 解釈する手順

- ブラウザが実行するJSやCSSファイルの末尾に以下のようなソースマップへの参照が含まれている

```
//# sourceMappingURL=example.min.js.map
```

- ブラウザはこのコメント行を見つけると、指定されたURL(上で言うexample.min.js.map)からソースマップファイルを取得する
- この.mapファイルを解析し、ミニファイ後のコードと元のソースコードの対応関係を把握する
- これにより、開発者ツールで元のソースコードをもとにデバッグできる

## 補足

- 元のソースコードが外部に漏れる可能性があるので、あえてソースマップ生成はしないこともあったりする
