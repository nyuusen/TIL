# CloudFront

なんとなく使っているCloudFrontを理解したい。
多分何が設定できるかを理解できたら使い方がわかるはずだからまずは設定できる内容を調査する。

## 基本用語

- CloudFrontディストリビューション: 
  - ユーザーが設定(作成)するCloudFrontリソース
- ビヘイビア: 
  - 振り分けルール
  - パスパターンでオリジンを振り分ける
  - `/api/*`はALBに、`/image/*`はS3にみたいな
- ビューア/オリジン
  - クライアント ==== ビューアリクエスト ==== CloudFrontディストリビューション ==== オリジンリクエスト ==== オリジン といった感じ。
    - 「リクエスト」の部分を「レスポンス」に置き換えると、ビューア/オリジンレスポンスの説明になる
  - ビューア/オリジンリクエスト/レスポンスにはCloudFront Functionを割り当てることが可能
    - 例えば、Authorizationヘッダを検証してBasic検証するとか

## ディストリビューションに設定できること

```
- コンテンツオリジン — CloudFront が配信するファイルの取得元である Amazon S3 バケット、AWS Elemental MediaPackage チャネル、AWS Elemental MediaStore コンテナ、Elastic Load Balancing ロードバランサー、または HTTP サーバーです。1 つのディストリビューションで、最大で 25 のオリジンの任意に組み合わせて指定できます。

- アクセス - ファイルをすべてのユーザーが使用できるようにするか、または一部のユーザーにアクセスを制限するか。

- セキュリティ - AWS WAF 保護を有効にして、HTTPS を使用したコンテンツへのアクセスを必須にするかどうか。

- キャッシュキー - キャッシュキーに含める値 (存在する場合)。キャッシュキーは、特定のディストリビューションのキャッシュ内の各ファイルを一意に識別します。

- オリジンリクエスト設定 - CloudFront でオリジンに送信するリクエストに HTTP ヘッダー、Cookie、またはクエリ文字列を含めるかどうか。

- 地理的制限 — CloudFront で特定の国のユーザーがコンテンツにアクセスできないようにするかどうか。

- ログ — CloudFront で標準ログを作成するか、ビューワーのアクティビティを示すリアルタイムログを作成するかどうか。
```

ref: [ディストリビューションの設定 - Amazon CloudFront](https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/distribution-working-with.html)

  