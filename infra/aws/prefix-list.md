# プレフィックスリスト

## プレフィックスリストとは？

- 複数のIPアドレス範囲をまとめて管理できる
- AWSが提供する「AWSマネージドプレフィックスリスト」と、ユーザー側が作成する「カスタマーマネージドプレフィックスリスト」が存在する
- 作成されたリージョンのみで利用可能
- セキュリティグループ等でIPアドレス単位で設定をする際に有用
- IPアドレスリストを手動で管理する際のオーバーヘッド発生を防ぐ
- AWS側が提供するIPアドレス情報に依存することで、設定ミス等を防ぐこともでき、セキュリティ的にも良い

## AWSが自動作成するプレフィックスリスト

- S3 VPCエンドポイント(ゲートウェイ型)
- Dynamo DB VPCエンドポイント(ゲートウェイ型)
- EC2 Instance Connect
- VPC Lattice
  ※よく見かけるものを抜粋

## 実際にどのような場面で役立つか？

### 同じ内容を持つ複数のセキュリティグループを作成したい場合

- 例えば、
  - セキュリティグループを用いてインバウンドルールの送信元IPアドレスを制御したい
  - 同様の内容を制御するセキュリティグループをいくつか作成したい
- 各セキュリティグループにIPアドレスを手打ちしていくのは手間がかかる＋設定ミスの恐れがある
- プレフィックスリストを使用することで、IPアドレスの設定を1箇所にまとめることができ、複数のセキュリティグループからそれを参照させることができる

### S3のVPCエンドポイント(ゲートウェイ型)を利用する時

- 接続元の方のルートテーブルに自動で生成される
- 以下のような内容
  - ターゲット: vpce-xxxxx
  - 送信先: pl-xxxx(自動生成されたプレフィックスリスト)

## 参考

- [AWS マネージドプレフィックスリスト - Amazon Virtual Private Cloud](https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/working-with-aws-managed-prefix-lists.html)
