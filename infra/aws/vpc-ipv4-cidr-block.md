# IPv4 VPC CIDRブロック

## 概要

VPCを作成するときに、そのVPCのIPv4 CIDRブロックを指定する必要がある。\
許可されるブロックは、/16ネットマスク（65,536個のIPアドレス）から/28ネットマスク（16個のIPアドレス）になる。

## CIDRブロックについて簡単に整理

- /数字の数字に当たる部分がネットワークアドレスとして固定化される
- IPアドレスは32ビットで表現される例えば/16の場合は、前半16ビットがネットワーク部・後半16ビットがホスト部になる
- 従来のクラスに縛られない効率的なIPアドレス管理を目的とした方法

## プライベートIPアドレスに指定する範囲

- 以下で設定されることが推奨されている
  ```
  10.0.0.0/8 – 範囲：10.0.0.0 ～ 10.255.255.255
  172.16.0.0/12 – 範囲：172.16.0.0 ～ 172.31.255.255
  192.168.0.0/16 – 範囲：192.168.0.0 ～ 192.168.255.255
  ```
  - これはRFC1918で指定されているもの

### ネットワーク部が固定数値である理由

例えば、/8(10.0.0.0/8)の場合の第1オクテッドがなぜ「10」であるのかが気になった。

- 結論：インターネット上の実際のパブリックIPアドレスと競合を防ぐため
- RFC1918で定義された範囲以外のIPアドレスをプライベートネットワークで使用すると、インターネット上のパブリックIPアドレスと競合する可能性がある
- そのため、インターネット上でユニークであることが保証されないプライベートネットワークでは、RFC1918で指定された「10.0.0.0/8」「172.16.0.0/12」「192.168.0.0/16」の範囲のみが使用されることが推奨されている

### RFC1918定義外のCIDRブロックは指定できるのか？

- それを検証している面白い記事を発見
  - [RFC 1918定義外のIPアドレスをVPCのCIDRブロックに指定してみた | DevelopersIO](https://dev.classmethod.jp/articles/assign-ip-addresses-outside-the-rfc-1918-definition-to-the-cidr-block-of-the-vpc/#toc-2)
- 設定はできるが、ALBターゲットに設定できなかったりと、色々な不具合があるらしい

## 参考

[VPC CIDR ブロック - Amazon Virtual Private Cloud](https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/vpc-cidr-blocks.html)
